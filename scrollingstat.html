<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status Viewer Recreation</title>
    <!-- Load Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Ensuring the body and HTML take full height for mobile view alignment */
        html, body {
            height: 100%;
            margin: 0;
            font-family: 'Inter', sans-serif;
            /* Use pure black for the background to match the screenshot */
            background-color: #000000;
        }

        /* Custom dark theme colors based on the screenshot */
        .bg-viewer-top { background-color: #000000; }
        .bg-viewer-bar { background-color: #202c33; }
        .text-timestamp { color: #8696a0; }

        /* The main viewer container that mimics the floating card */
        .viewer-container {
            max-width: 400px;
            width: 100%;
            /* Use 100% height on mobile, fixed height on desktop */
            height: 100%; 
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.5);
        }

        /* Custom circle for profile icons */
        .profile-circle {
            /* INCREASED SIZE for viewer list items */
            width: 48px; 
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            font-weight: bold;
            color: white;
            flex-shrink: 0;
            overflow: hidden;
            border: 2px solid transparent; 
            position: relative; /* Needed for img and border */
        }
        /* Style for the green hairline border */
        .profile-circle.has-border {
             border-color: #1FAF59; /* Green color for the hairline */
        }
        
        /* The header profile circle (My status) remains 40px */
        .header-profile-circle {
             width: 40px;
             height: 40px;
        }


        /* SVG for the Back Arrow Icon */
        .icon-back {
            fill: white;
            width: 24px;
            height: 24px;
        }
        
        /* Animation for the counting text */
        @keyframes subtle-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-1px); }
        }
        .animate-count {
            animation: subtle-bounce 0.2s ease-out;
        }
        
        /* --- Static Progress Bar Styling --- */
        .progress-bar-track {
            background-color: #8696a0; /* Dim color for unfilled/pending segments */
            border-radius: 1px;
            overflow: hidden;
            position: relative;
        }

        .progress-segment-inner {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background-color: white; /* Color of the filled progress */
            width: 0%; /* Default: Hidden or 0 width */
        }
        
        /* Class for fully completed segments */
        .done-fill {
            width: 100%;
        }

        /* --- Realistic Scrolling Simulation (Upwards scroll with gradual pauses) --- */
        @keyframes realisticScroll {
            /* Start */
            0% { transform: translateY(0); }
            
            /* Scroll 1: Decelerate smoothly to the first pause point */
            20% { 
                transform: translateY(-10%); 
                /* Ease-out timing: Starts fast, slows down to stop */
                animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1.0); 
            } 
            
            /* Pause 1: Hold the position. This keyframe defines the timing function for the next segment. */
            25% { 
                transform: translateY(-10%); 
                /* Ease-in timing: Starts slow (like moving from a stop), accelerates */
                animation-timing-function: cubic-bezier(0.8, 0.0, 0.6, 1.0); 
            } 

            /* Scroll 2: Decelerate smoothly to the second pause point */
            50% { 
                transform: translateY(-35%); 
                /* Ease-out timing: Starts fast, slows down to stop */
                animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1.0);
            } 

            /* Pause 2: Hold the position. This keyframe defines the timing function for the next segment. */
            55% { 
                transform: translateY(-35%); 
                 /* Ease-in timing: Starts slow (like moving from a stop), accelerates */
                animation-timing-function: cubic-bezier(0.8, 0.0, 0.6, 1.0); 
            }
            
            /* Scroll 3: Decelerate smoothly to the loop point */
            80% { 
                transform: translateY(-50%); 
                /* Ease-out timing: Starts fast, slows down before the jump */
                animation-timing-function: cubic-bezier(0.4, 0.0, 0.2, 1.0);
            } 

            /* Instant loop back to the start (visually seamless) */
            100% { transform: translateY(0); } 
        }

        /* Apply the animation to the list container */
        .scrolling-list {
            /* Slower animation for observable movement and pauses */
            animation: realisticScroll 25s linear infinite; 
            display: flex;
            flex-direction: column;
            will-change: transform; /* Performance optimization */
        }
        
        #viewerListWrapper {
            overflow: hidden; /* Hide content outside the viewport */
            flex-grow: 1; 
        }
        
        /* Style the Reshare SVG: fill is none, stroke color is inherited from parent text color (text-timestamp) */
        .reshare-icon-svg {
            fill: none; 
            stroke-width: 2; 
            stroke: currentColor; 
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        /* Container for the Facebook icon */
        .facebook-icon-container {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px; 
            border: 1px solid white; 
            position: relative;
            background-color: white; 
        }

        /* SVG for the actual Facebook 'f' inside */
        .facebook-svg {
            width: 100%;
            height: 100%;
            display: block;
            position: relative; 
        }
        
        /* Custom CSS for Gold Gradient Text on NEARR */
        .gold-gradient-text {
            /* Create a gold gradient */
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 45%, #FFD700 70%, #DAA520 100%);
            /* Apply the gradient to the text */
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent; /* Text color must be transparent for gradient to show */
            display: inline-block; /* Essential for text gradient */
        }
    </style>
</head>
<body class="bg-viewer-top flex flex-col items-center justify-start lg:justify-center min-h-screen">

    <!-- Screen Mockup Container (Mobile View) --><div class="viewer-container bg-gray-900 flex flex-col rounded-lg lg:rounded-xl overflow-hidden">

        <!-- Status Progress Bar Strip (5 Horizontal Lines) --><div id="progressBars" class="flex px-1 pt-2 bg-viewer-top flex-shrink-0 space-x-0.5"> 
            <!-- Segment 1: DONE (White) --><div class="progress-segment h-[2px] flex-grow progress-bar-track">
                <div class="progress-segment-inner done-fill"></div>
            </div>
            <!-- Segment 2: DONE (White) --><div class="progress-segment h-[2px] flex-grow progress-bar-track">
                <div class="progress-segment-inner done-fill"></div>
            </div>
            <!-- Segment 3: DONE (White) --><div class="progress-segment h-[2px] flex-grow progress-bar-track">
                <div class="progress-segment-inner done-fill"></div>
            </div>
            <!-- Segment 4: DONE (White) --><div class="progress-segment h-[2px] flex-grow progress-bar-track">
                <div class="progress-segment-inner done-fill"></div>
            </div>
            <!-- Segment 5: EMPTY (Gray with NO white fill) --><div class="progress-segment h-[2px] flex-grow progress-bar-track">
                <div class="progress-segment-inner"></div> 
            </div>
        </div>

        <!-- Top Bar (Header: Back, Profile, Status Name, Menu) -->
        <div class="flex items-center py-2 px-3 bg-viewer-top flex-shrink-0">
            <!-- 1. Back Arrow --><svg class="icon-back mr-4" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M19 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H19v-2z"/>
            </svg>

            <!-- 2. Profile Icon/Avatar with Green Plus -->
            <div class="profile-circle header-profile-circle bg-gray-600 mr-4 relative flex-shrink-0">
                 <!-- User's Logo (NEARR logo) -->
                 <img 
                    src="uploaded:Screenshot_20251124-211150.jpg-98e6b0eb-853b-467c-a5e4-51e650baeec9" 
                    class="w-full h-full object-cover rounded-full" 
                    alt="NEARR Logo Profile Picture"
                    onerror="this.onerror=null; this.src='https://placehold.co/40x40/333333/FFFFFF?text=N'"
                 />

                <!-- Green Plus Icon (Status Adder) -->
                <svg class="absolute bottom-[-1px] right-[-1px] w-4 h-4 text-white bg-green-500 rounded-full border-2 border-black" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/>
                </svg>
            </div>

            <!-- 3. Name and Time -->
            <div class="flex-grow">
                <p class="text-white text-base font-semibold">My status</p>
                <p class="text-xs text-timestamp flex items-center">
                    <!-- Time value container for JS animation -->
                    <span id="statusTimeText">1m</span>
                    
                    <!-- Reshare Icon (SVG with stroke="currentColor") -->
                    <svg class="w-4 h-4 mx-1 reshare-icon-svg" viewBox="0 0 24 24" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 12a9 9 0 1 1-9-9c1.07 0 2.1.28 3.01.81m-3.01 5.19V6.5L8.5 9 12 12.5V10h7v2h-7z"/>
                    </svg>
                    
                    <span>Reshared</span>
                </p>
            </div>

            <!-- 4. 3-dot menu (Right side) -->
            <div class="ml-auto p-2">
                 <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="currentColor">
                    <circle cx="12" cy="12" r="1.5"/>
                    <circle cx="12" cy="5" r="1.5"/>
                    <circle cx="12" cy="19" r="1.5"/>
                </svg>
            </div>
        </div>

        <!-- Video Placeholder / Main Status Content Area -->
        <div class="p-2 pt-0 h-52 flex items-center justify-center flex-shrink-0">
            <div class="w-full h-full bg-gray-700 rounded-md flex items-center justify-center relative overflow-hidden">
                
                <!-- Removed: 1. Logo Background Image -->
                <!-- Removed: 2. Dark Overlay for Contrast -->
                
                <!-- 3. Text Content (NEARR and Slogan) -->
                <div class="relative z-10 text-center p-4">
                    <h2 class="text-6xl font-extrabold tracking-widest leading-none" style="text-shadow: 0 4px 8px rgba(0,0,0,0.5);">
                        <span class="gold-gradient-text">NEARR</span>
                    </h2>
                    <!-- Modified: Slogan text smaller and italic -->
                    <p class="text-white text-sm mt-2 font-medium italic">
                        unimaginable possibilities are NEARR
                    </p>
                </div>
                
                <!-- Removed: 'AC' badge placeholder -->
            </div>
        </div>

        <!-- Viewer List Card (Flex-grow ensures it fills the rest of the screen height) -->
        <div class="flex-grow bg-[#272727] pt-2 rounded-t-xl flex flex-col min-h-0">

            <!-- Viewer Header Bar (Viewed by 42) -->
            <div class="flex items-center justify-between px-4 py-2 border-b border-gray-700 flex-shrink-0">
                <div class="flex items-center">
                    <span class="text-white text-base font-semibold mr-1">Viewed by</span>
                    <!-- VIEW COUNT ANIMATION ELEMENT -->
                    <span id="viewCountText" class="text-white text-lg font-bold">324</span>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Facebook Icon (Maximized 'f') -->
                    <div class="facebook-icon-container">
                        <svg class="facebook-svg" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M11.6667 12.6667H13.3333L13.8333 9.16667H11.6667V7.33333C11.6667 6.33333 12.0833 6.0 12.9167 6.0H14.1667V2.5C13.9213 2.46944 13.0456 2.41667 12.0833 2.41667C9.91667 2.41667 8.5 3.75 8.5 6.0V9.16667H6.66667V12.6667H8.5V19.5H11.1667V12.6667Z" fill="#000000"/>
                        </svg>
                    </div>
                    <!-- Three Dots Menu Placeholder -->
                    <svg class="w-5 h-5 text-white" viewBox="0 0 24 24" fill="currentColor">
                        <circle cx="12" cy="12" r="1.5"/>
                        <circle cx="12" cy="5" r="1.5"/>
                        <circle cx="12" cy="19" r="1.5"/>
                    </svg>
                </div>
            </div>

            <!-- Viewer List Items Wrapper - Defines the visible scroll area -->
            <div id="viewerListWrapper" class="overflow-y-auto flex-grow pb-4">
                <!-- Viewer List Items Container - The 'scrolling-list' class is added here by JS -->
                <div id="viewerList">
                    <!-- Dynamic viewer items will be injected here -->
                </div>
            </div>
            
        </div>
    </div>

    <script>
        const NUM_STEPS = 35; // Steps for time counter
        const NUM_VIEW_STEPS = 60; // Desired number of steps for view counter
        const START_VIEWS = 324;
        const END_VIEWS = 1000000;
        const TOTAL_DURATION_VIEW_TIME = 60000; // 1 minute in milliseconds for the counters
        const TOTAL_VIEWERS = 200; // Total names to generate for scrolling list
        const NUM_UTV = 90; // 90 names get UTV appended
        const NUM_EMOJI = 60; // 60 names get an emoji appended
        const NUM_AVATAR = 150; 
        
        // Emojis provided by the user
        const EMOJIS = ['ü§¥', 'üíì', 'üíñ', 'üßë‚Äçüéì', 'ü§≥', 'üëè', 'üíï', 'üôÜ', 'üëº', 'üß°', 'üíØ', 'üíñ', 'üíì', 'üî•', 'üí•', 'üí´', 'ü§ñ', 'üíå', 'üèãÔ∏è', 'üëÆ', 'üòÅ', 'ü§ù', 'üëª', 'ü§ó', 'üö∂', 'üíù', 'ü§ç', 'üòÅ'];
        
        // Common name parts for generating unique names
        const FIRST_NAMES = ["Alex", "Ben", "Chris", "Dana", "Eli", "Fin", "Grace", "Henry", "Ivy", "Jack", "Kate", "Leo", "Mia", "Noah", "Oli", "Piper", "Quinn", "Ryan", "Sara", "Tom", "Uma", "Victor", "Will", "Xena", "Yara", "Zack", "Aisha", "Bayo", "Caleb", "Devi", "Elias", "Femi", "Gia", "Idris", "Jaya", "Kofi", "Lena", "Musa", "Nala", "Omar", "Priya", "Rami", "Sita", "Tariq", "Zara", "John", "Jane", "Max", "Chloe", "Sam", "Ruby", "Liam", "Emma", "Ethan", "Olivia"];
        const LAST_NAMES = ["Smith", "Jones", "Garcia", "Miller", "Davis", "Rodgers", "Wilson", "Moore", "Taylor", "Anderson", "Thomas", "Jackson", "White", "Harris", "Martin", "Lee", "Perez", "King", "Wright", "Baker", "Hill", "Adams", "Clark", "Young", "Scott", "Walker", "Hall", "Allen", "Cook", "Morris", "Rivera", "Gonzales", "Nelson", "Carter", "Mitchell"];

        // === Utility Function to Format Time (Header) ===
        function formatTime(totalMinutes) {
            if (totalMinutes < 60) {
                // If less than an hour, show in minutes
                return `${totalMinutes}m`;
            } else if (totalMinutes < 1440) {
                // If less than 24 hours, show in hours
                const hours = Math.floor(totalMinutes / 60);
                return `${hours}h`;
            } else if (totalMinutes === 1440) {
                return `24hr`;
            } 
            return `>24hr`;
        }

        // === Utility Function to Format View Count (K/M notation) ===
        function formatViewCount(num) {
            if (num >= 1000000) {
                // Handles 1,000,000 and above using 1.0M format (or 1M if exactly 1,000,000)
                if (num === 1000000) return '1M';
                return (num / 1000000).toFixed(1).replace(/\.0$/, '') + 'M';
            } else if (num >= 1000) {
                // Check if rounding would result in 1000K, which is wrong.
                const kValue = Math.round(num / 1000);
                if (kValue >= 1000) {
                    // Force display as 1M if it rounds up to 1000K or more
                    return '1M';
                }
                return kValue + 'K';
            }
            return num.toString();
        }

        // === Generalized Step Generation Function (Used for Time only now) ===
        function generateRandomSteps(start, end, numSteps) {
            const steps = [start];
            const range = end - start;
            const randomFractions = [];
            
            for (let i = 0; i < numSteps - 2; i++) {
                randomFractions.push(Math.random());
            }
            randomFractions.sort((a, b) => a - b);
            
            for (const fraction of randomFractions) {
                const biasedFraction = Math.pow(fraction, 1.5); 
                const value = Math.round(start + biasedFraction * range);
                steps.push(value);
            }
            
            steps.push(end);
            
            return [...new Set(steps)].sort((a, b) => a - b);
        }

        // === Function for Realistic View Count Steps (Controlled Exponential Growth) ===
        function generateRealisticViewSteps(start, end, numSteps) {
            const steps = [start];
            const range = end - start;
            const exponent = 4; // Exponent for strong acceleration towards the end
            
            for (let i = 1; i <= numSteps; i++) {
                const normalizedStep = i / numSteps;
                const biasedPosition = Math.pow(normalizedStep, exponent);
                
                let theoreticalValue = start + biasedPosition * range;
                
                const noiseMagnitude = Math.min(100, theoreticalValue * 0.015); 
                const noise = (Math.random() - 0.5) * 2 * noiseMagnitude; 
                
                let nextValue = Math.round(theoreticalValue + noise);
                
                // Ensure the value progresses and doesn't exceed the end target
                if (nextValue > steps[steps.length - 1] && nextValue <= end) {
                    steps.push(nextValue);
                }
            }
            
            if (steps[steps.length - 1] !== end) {
                steps.push(end);
            }
            
            return [...new Set(steps)].sort((a, b) => a - b);
        }


        /**
         * Starts a counter animation, time-constrained to totalDuration.
         */
        function startCounterAnimation(elementId, steps, formatter, totalDuration) {
            const element = document.getElementById(elementId);
            if (!element) return;

            let index = 0;
            let timeElapsed = 0;
            const totalSteps = steps.length;
            const startTime = performance.now();

            const animateStep = () => {
                const currentTime = performance.now();
                timeElapsed = currentTime - startTime;
                
                const stepsTarget = Math.min(totalSteps, Math.round((timeElapsed / totalDuration) * totalSteps));
                
                if (index < stepsTarget) {
                    index = stepsTarget;
                }

                if (index >= totalSteps) {
                    element.textContent = formatter(steps[totalSteps - 1]);
                    return; 
                }

                const value = steps[index];
                element.textContent = formatter(value);
                
                element.classList.add('animate-count');
                setTimeout(() => element.classList.remove('animate-count'), 200);

                index++;

                const stepsLeft = totalSteps - index;
                const timeRemaining = totalDuration - timeElapsed;
                
                let delay;

                if (stepsLeft > 0) {
                    let averageStepDuration = timeRemaining / stepsLeft;
                    let randomDelayFactor = (Math.random() * 0.6) - 0.3; 
                    delay = averageStepDuration * (1 + randomDelayFactor);
                    
                    delay = Math.min(Math.max(100, delay), timeRemaining); 
                    
                    setTimeout(animateStep, delay);
                }
            };
            
            setTimeout(animateStep, 500);
        }
        
        // === Viewer List Time Generation and Formatting Utilities ===

        /**
         * Converts minutes elapsed since the current moment into a formatted time string.
         * Logic: X Minutes ago, Today, HH:MM, or Yesterday, HH:MM.
         */
        function formatViewerTime(minutesElapsed) {
            if (minutesElapsed < 60) {
                // Less than 1 hour: X Minutes ago
                // Use a slight variation on the minutes to make the list look less uniform
                const displayMinutes = Math.max(1, minutesElapsed);
                return `${displayMinutes} Minutes ago`;
            } 

            // Calculate the date/time of the view by subtracting the elapsed milliseconds
            const now = new Date();
            const viewTimeMs = now.getTime() - (minutesElapsed * 60 * 1000);
            const viewDate = new Date(viewTimeMs);

            const viewHour = viewDate.getHours();
            const viewMinute = viewDate.getMinutes();
            
            // Format to 12-hour AM/PM string
            const hour12 = viewHour % 12 || 12; // Convert 0 (midnight) to 12
            const minuteStr = String(viewMinute).padStart(2, '0');
            const ampm = viewHour >= 12 ? 'PM' : 'AM';
            const timeString = `${hour12}:${minuteStr} ${ampm}`;

            // Get the start of today (midnight)
            const startOfToday = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
            
            // Check if the view time is later than midnight today
            if (viewTimeMs >= startOfToday) {
                return `Today, ${timeString}`;
            }
            
            // If the view time is before midnight today, it was yesterday (since we limit elapsed time to 24 hours)
            return `Yesterday, ${timeString}`;
        }
        
        // === Viewer List Generation Utilities ===

        function getRandomElement(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        // --- NEW/MODIFIED FUNCTION TO GENERATE IMAGE URLS ---
        function getRandomAvatarUrl(size = 48) {
            // Using placeholder images for diverse looks
            const categories = [
                'person', 'face', 'portrait', 'user', 'profile'
            ];
            const randomCategory = getRandomElement(categories);
            const randomId = Math.floor(Math.random() * 100) + 1; // Unique ID for different image look
            
            // Using a free image service that provides random placeholder images
            const useColor = Math.random() < 0.8;
            const filter = useColor ? '' : '/g'; // Add grayscale filter occasionally
            
            // Generate a random, varied size near the target 48x48
            const finalSize = size + Math.floor(Math.random() * 6) - 3; 

            // Using picsum for random, diverse images
            return `https://picsum.photos/seed/${randomCategory}-${randomId}${filter}/${finalSize}`;
        }
        // --- END NEW/MODIFIED FUNCTION ---

        // === Viewer List Generation (Main Function) ===
        function generateViewerList() {
            const listContainer = document.getElementById('viewerList');
            if (!listContainer) return;

            let viewerData = [];
            const viewerColors = ['bg-indigo-600', 'bg-blue-600', 'bg-green-600', 'bg-red-600', 'bg-purple-600']; 

            let uniqueNames = new Set();
            while (uniqueNames.size < TOTAL_VIEWERS) {
                const firstName = getRandomElement(FIRST_NAMES);
                const lastName = getRandomElement(LAST_NAMES);
                uniqueNames.add(`${firstName} ${lastName}`);
            }
            
            const namesArray = Array.from(uniqueNames);
            
            const indices = Array.from({ length: TOTAL_VIEWERS }, (_, i) => i);

            const utvIndices = new Set(
                indices.slice().sort(() => 0.5 - Math.random()).slice(0, NUM_UTV)
            );

            const emojiIndices = new Set(
                indices.slice().sort(() => 0.5 - Math.random()).slice(0, NUM_EMOJI)
            );
            
            const avatarIndices = new Set(
                indices.slice().sort(() => 0.5 - Math.random()).slice(0, NUM_AVATAR)
            );

            for (let i = 0; i < TOTAL_VIEWERS; i++) {
                const baseName = namesArray[i];
                const hasUtv = utvIndices.has(i);
                const hasEmoji = emojiIndices.has(i);
                const hasAvatar = avatarIndices.has(i); 
                
                const initials = baseName.split(' ').map(n => n[0]).join('');
                
                let finalName = baseName;
                
                if (hasEmoji) {
                    const emoji = getRandomElement(EMOJIS);
                    finalName += ` ${emoji}`;
                }

                if (hasUtv) {
                    finalName += ` UTV`;
                }
                
                const hasGreenHairline = hasAvatar || (Math.random() < 0.3);
                
                // Generate minutes elapsed: 2 minutes (newest) to 1440 minutes (24 hours/oldest)
                // Use a bias: use Math.pow to make more views recent (smaller minutesElapsed)
                let randomFraction = Math.random();
                let minutesElapsed = Math.floor(Math.pow(randomFraction, 0.5) * (1440 - 2)) + 2; 

                viewerData.push({
                    name: finalName,
                    initials: initials,
                    color: getRandomElement(viewerColors),
                    minutesElapsed: minutesElapsed, // Store the numeric value for sorting
                    hasAvatar: hasAvatar,
                    avatarUrl: hasAvatar ? getRandomAvatarUrl() : null,
                    hasGreenHairline: hasGreenHairline 
                });
            }

            // CRITICAL CHANGE: Sort the data by minutesElapsed in ASCENDING order.
            // Smallest elapsed time = Newest view, which goes at the top.
            viewerData.sort((a, b) => a.minutesElapsed - b.minutesElapsed);
            
            let listHtml = '';
            viewerData.forEach(viewer => {
                const borderClass = viewer.hasGreenHairline ? 'has-border' : '';
                
                let avatarContent;
                let circleClasses = viewer.color;
                
                if (viewer.hasAvatar) {
                    circleClasses = 'bg-gray-700'; 
                    const fallbackUrl = `https://placehold.co/48x48/CCCCCC/333333?text=${viewer.initials}`;

                    avatarContent = `
                        <img 
                            src="${viewer.avatarUrl}" 
                            class="w-full h-full object-cover rounded-full" 
                            onerror="this.onerror=null; this.src='${fallbackUrl}'" 
                            alt="${viewer.name}'s Avatar"
                        />`;
                } else {
                    avatarContent = viewer.initials;
                    circleClasses = viewer.color; 
                }
                
                // CRITICAL CHANGE: Format the time here using the new function
                const formattedTime = formatViewerTime(viewer.minutesElapsed);

                listHtml += `
                <div class="viewer-item flex items-center p-3 hover:bg-gray-800 transition duration-150">
                    <div class="profile-circle text-xs mr-4 ${circleClasses} ${borderClass}">
                        ${avatarContent}
                    </div>
                    <div>
                        <p class="text-white text-base">${viewer.name}</p>
                        <p class="text-timestamp text-sm">${formattedTime}</p>
                    </div>
                </div>`;
            });
            
            // CRITICAL STEP: Clone the content to enable seamless CSS scrolling animation
            listContainer.innerHTML = listHtml + listHtml;

            // Apply the scrolling class to the list container
            listContainer.classList.add('scrolling-list');
        }

        // === Main Initialization ===
        window.addEventListener('load', () => {
            // Start counter animations
            const viewSteps = generateRealisticViewSteps(START_VIEWS, END_VIEWS, NUM_VIEW_STEPS);
            startCounterAnimation('viewCountText', viewSteps, formatViewCount, TOTAL_DURATION_VIEW_TIME);

            const startValueTime = 1; 
            const endValueTime = 1440; 
            const timeSteps = generateRandomSteps(startValueTime, endValueTime, NUM_STEPS);
            startCounterAnimation('statusTimeText', timeSteps, formatTime, TOTAL_DURATION_VIEW_TIME);

            // Generate and setup the large viewer list with scrolling
            generateViewerList();
        });
    </script>
</body>
</html>

